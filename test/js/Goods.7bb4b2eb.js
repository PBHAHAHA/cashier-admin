import{l as ye,m as ke,n as we,o as xe,p as Ee,q as Ue,r as ze,s as Ce,t as Le,u as Se,v as Ne,j as Pe,w as Be,x as De,y as Te,A as m,B as $e}from"./element-plus.e2f6c87e.js";import"./vue.71d9eb96.js";import{p as Ge,a as Me,u as M,b as te,c as Fe,d as je,s as He,e as Re}from"./api.6033fc19.js";import{_ as qe}from"./index.fb21dd1c.js";import{b as Ae,p as F,u as Oe,e as Qe,_ as We,m as Je}from"./@element-plus.ffb1aafe.js";import{$ as j,b as f,i as Ke,o as x,c as H,a as u,W as s,u as a,Q as n,G as L,F as R,U as g,V as S,R as oe,P as q,T as A,a5 as Xe,ax as Ye,ay as Ze}from"./@vue.261fc3d1.js";import"./lodash-es.39464d94.js";import"./@vueuse.95af7be7.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./axios.451cdb92.js";import"./async-validator.55f0915b.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.6a15212d.js";import"./qs.541cb51f.js";import"./side-channel.ba01de6f.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.01dab752.js";import"./vue-router.921957ed.js";import"./pinia.e3c5cb31.js";import"./vue-demi.0e4c1019.js";import"./default-passive-events.a10ec130.js";const N=U=>(Ye("data-v-53922493"),U=U(),Ze(),U),el={class:"page-main"},ll={class:"searchbox"},al={class:"search-item"},tl=N(()=>u("div",{class:"search-label"},"\u5546\u54C1\u6807\u9898",-1)),ol={class:"search-item"},sl=N(()=>u("div",{class:"search-label"},"\u5546\u54C1\u8D27\u53F7",-1)),il={class:"search-item"},nl=N(()=>u("div",{class:"search-label"},"\u5382\u5546\u540D\u79F0",-1)),rl={class:"pls"},dl={class:"tablelist"},ul={class:"imgbox"},pl={class:"pagebox"},cl={class:"form-cont"},ml={class:"pvder"},fl=N(()=>u("div",{class:"label"},"\u6279\u91CF\u8BBE\u7F6E\u4EF7\u683C\uFF0C\u5E93\u5B58",-1)),gl={class:"dialog-footer"},_l=["src"],hl={__name:"Goods",setup(U){const _=j({title:"",artNo:"",supplierName:""}),O=f([]),Q=f(0);Ke(()=>{Q.value=window.innerHeight-220});const p=j({currentPage:1,pageSize:30,total:0}),se=i=>{p.pageSize=i,p.currentPage=1,I()},ie=i=>{p.currentPage=i,I()};function ne(){p.currentPage=1,I()}const P=f(!1);async function I(){var l,d;if(P.value)return;P.value=!0;let i={..._,pageNo:p.currentPage,pageSize:p.pageSize},e=await Ge(i);e.code===0?(O.value=((l=e==null?void 0:e.data)==null?void 0:l.records)||[],p.total=(d=e==null?void 0:e.data)==null?void 0:d.totalCount):m.error((e==null?void 0:e.msg)||"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF"),P.value=!1}function re(i){return i.size/1024/1024>300?(m.error("\u56FE\u7247\u5305\u4E0D\u80FD\u8D85\u8FC7300MB!"),!1):(k.value=!0,!0)}const k=f(!1);function de(i){console.log(i),m.success("\u6279\u91CF\u4E0A\u4F20\u6210\u529F"),k.value=!1,p.currentPage=1,p.total=0,_.title="",_.artNo="",_.supplierName="",I()}function ue(){m.error("\u6279\u91CF\u4E0A\u4F20\u5931\u8D25"),k.value=!1}const W=i=>{i.msg==="success"?k.value=!0:(m.error(i.msg),k.value=!1)};function pe(i){$e.confirm("\u662F\u5426\u5220\u9664\u8BE5\u5546\u54C1?","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{let e=await Fe({id:i.id,formData:!0});e.code===0?(m.success("\u5220\u9664\u6210\u529F"),I()):m.error((e==null?void 0:e.msg)||"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF")})}const b=f(!1),h=f(1);function ce(){h.value=1,b.value=!0,o.title="",o.artNo="",o.supplierId="",o.colors=[],o.sizes=[],o.skuList=[],o.indexImages=[],o.detailImages=[],o.id="",V.value="",y.value=""}const B=f(!1);async function me(i){if(B.value)return;B.value=!0,V.value="",y.value="";let e=await je({id:i.id});if(e.code===0){let{data:l}=e;h.value=2,b.value=!0,z.value=[{name:l==null?void 0:l.supplierName,id:l==null?void 0:l.supplierId}],o.title=(l==null?void 0:l.title)||"",o.artNo=(l==null?void 0:l.artNo)||"",o.supplierId=(l==null?void 0:l.supplierId)||"",o.id=l==null?void 0:l.id;let d=[],c=[];l==null||l.skuList.forEach(r=>{delete r.productId,d.push(r.color),c.push(r.size)}),o.skuList=(l==null?void 0:l.skuList)||[],o.colors=[...new Set(d)],o.sizes=[...new Set(c)],o.indexImages=[],o.detailImages=[],l.imgList.forEach(r=>{r.type===1&&o.indexImages.push({path:r.url,url:r.showImg,ntpath:r.url}),r.type===2&&o.detailImages.push({path:r.url,url:r.showImg,ntpath:r.url})}),console.log(o)}else m.error((e==null?void 0:e.msg)||"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF");B.value=!1}const o=j({title:"",artNo:"",supplierId:"",colors:[],sizes:[],skuList:[],indexImages:[],detailImages:[],id:""}),D=f(!1),z=f([]),fe=async i=>{if(i.trim()){D.value=!0;let e=await He({name:i,formData:!0});e.code===0&&(z.value=e.data||[]),D.value=!1}else z.value=[]};function J(){let{colors:i,sizes:e}=o,l=[...i],d=[...e];if(l.length&&d.length){let c=[];l.forEach(r=>{d.forEach($=>{c.push({color:r,size:$,price:"",stock:"",id:""})})}),o.skuList=c}else o.skuList=[]}const V=f(""),y=f("");function ge(){if(!V.value&&!y.value)return m.warning("\u8BF7\u8F93\u5165\u4EF7\u683C\u548C\u5E93\u5B58");o.skuList.forEach(i=>{i.price=V.value,i.stock=y.value})}const K=(i,e)=>{console.log(i,e)},X=f(""),C=f(!1),T=i=>{X.value=i.url,C.value=!0},_e=()=>{m.warning("\u6700\u591A\u4E0A\u4F205\u5F20\u56FE\u7247")},he=()=>{m.warning("\u6700\u591A\u4E0A\u4F2050\u5F20\u56FE\u7247")},E=f(!1);async function Y(){if(E.value)return;E.value=!0;let i={artNo:o.artNo,supplierId:o.supplierId,title:o.title,skuList:o.skuList};h.value===2&&(i.id=o.id),i.indexImages=[],o.indexImages.forEach(l=>{var d,c;l!=null&&l.ntpath&&i.indexImages.push(l.ntpath),(c=(d=l==null?void 0:l.response)==null?void 0:d.data)==null||c.forEach(r=>{i.indexImages.push(r.path)})}),i.detailImages=[],o.detailImages.forEach(l=>{var d,c;l!=null&&l.ntpath&&i.detailImages.push(l.ntpath),(c=(d=l==null?void 0:l.response)==null?void 0:d.data)==null||c.forEach(r=>{i.detailImages.push(r.path)})}),i.skuList.forEach(l=>{l.id||delete l.id}),console.log(o),console.warn(i);let e=await Re(i);e.code===0?(h.value===1?m.success("\u65B0\u589E\u6210\u529F"):m.success("\u4FEE\u6539\u6210\u529F"),h.value===1&&(p.currentPage=1),I(),b.value=!1):m.error((e==null?void 0:e.msg)||"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF"),E.value=!1}return I(),(i,e)=>{const l=ye,d=ke,c=we,r=xe,$=Ee,ve=Ue,Z=ze,Ie=Ce,v=Le,be=Se,G=Ne,ee=Pe,Ve=Be,le=De,ae=Te;return x(),H(R,null,[u("div",el,[u("div",ll,[u("div",al,[tl,s(l,{modelValue:a(_).title,"onUpdate:modelValue":e[0]||(e[0]=t=>a(_).title=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u6807\u9898"},null,8,["modelValue"])]),u("div",ol,[sl,s(l,{modelValue:a(_).artNo,"onUpdate:modelValue":e[1]||(e[1]=t=>a(_).artNo=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u8D27\u53F7"},null,8,["modelValue"])]),u("div",il,[nl,s(l,{modelValue:a(_).supplierName,"onUpdate:modelValue":e[2]||(e[2]=t=>a(_).supplierName=t),placeholder:"\u8BF7\u8F93\u5165\u5382\u5546\u540D\u79F0"},null,8,["modelValue"])]),s(d,{type:"primary",icon:a(Ae),onClick:ne},{default:n(()=>[g("\u641C\u7D22")]),_:1},8,["icon"]),s(d,{type:"primary",icon:a(F),onClick:ce},{default:n(()=>[g("\u6DFB\u52A0\u5546\u54C1")]),_:1},8,["icon"]),u("div",rl,[s(c,{action:a(Me),accept:".zip,.rar,.7z,.tar,.wim",headers:a(M)(),"show-file-list":!1,"on-success":de,"before-upload":re,"on-error":ue},{default:n(()=>[s(d,{type:"primary",icon:a(Oe),loading:a(k)},{default:n(()=>[g("\u6279\u91CF\u4E0A\u4F20")]),_:1},8,["icon","loading"])]),_:1},8,["action","headers"])])]),u("div",dl,[s(Z,{data:a(O),border:"",stripe:"",class:"ctanel","header-cell-style":{background:"#f5f7fa"},height:a(Q)},{empty:n(()=>[s(ve,{description:"\u6682\u65E0\u6570\u636E"})]),default:n(()=>[s(r,{label:"\u5546\u54C1\u6807\u9898"},{default:n(({row:t})=>[g(S(t.title),1)]),_:1}),s(r,{label:"\u5546\u54C1\u56FE\u7247",width:"148"},{default:n(({row:t})=>[u("div",ul,[s($,{src:t.showIndexImage,class:"shoumain",onClick:w=>T({url:t.showIndexImage})},null,8,["src","onClick"])])]),_:1}),s(r,{label:"\u5546\u54C1\u8D27\u53F7"},{default:n(({row:t})=>[g(S(t.artNo),1)]),_:1}),s(r,{label:"\u5546\u54C1\u4EF7\u683C"},{default:n(({row:t})=>[g(S(t.prices),1)]),_:1}),s(r,{label:"\u6240\u5C5E\u5382\u5546"},{default:n(({row:t})=>[g(S(t.supplierName),1)]),_:1}),s(r,{label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime"}),s(r,{label:"\u64CD\u4F5C",width:"170"},{default:n(({row:t})=>[s(d,{type:"primary",icon:a(Qe),link:"",onClick:w=>me(t)},{default:n(()=>[g("\u7F16\u8F91")]),_:2},1032,["icon","onClick"]),s(d,{type:"danger",icon:a(We),onClick:w=>pe(t),link:""},{default:n(()=>[g("\u5220\u9664")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data","height"]),u("div",pl,[s(Ie,{"current-page":a(p).currentPage,"onUpdate:current-page":e[3]||(e[3]=t=>a(p).currentPage=t),"page-size":a(p).pageSize,"onUpdate:page-size":e[4]||(e[4]=t=>a(p).pageSize=t),"page-sizes":[30,80,150,300],background:"",layout:"total, sizes, prev, pager, next, jumper",total:a(p).total,onSizeChange:se,onCurrentChange:ie},null,8,["current-page","page-size","total"])])])]),s(le,{title:`${a(h)===1?"\u6DFB\u52A0":"\u7F16\u8F91"}\u5546\u54C1`,modelValue:a(b),"onUpdate:modelValue":e[17]||(e[17]=t=>L(b)?b.value=t:null),width:"800px","close-on-click-modal":!1},{footer:n(()=>[u("span",gl,[s(d,{onClick:e[16]||(e[16]=t=>b.value=!1)},{default:n(()=>[g("\u53D6\u6D88")]),_:1}),a(h)===1?oe((x(),q(d,{key:0,type:"primary",onClick:Y},{default:n(()=>[g("\u4FDD\u5B58")]),_:1})),[[ae,a(E)]]):A("v-if",!0),a(h)===2?oe((x(),q(d,{key:1,type:"primary",onClick:Y},{default:n(()=>[g("\u4FEE\u6539")]),_:1})),[[ae,a(E)]]):A("v-if",!0)])]),default:n(()=>[u("div",cl,[s(Ve,{model:a(o),"label-width":"110px"},{default:n(()=>[s(v,{label:"\u5546\u54C1\u6807\u9898 (\u5FC5\u586B)"},{default:n(()=>[s(l,{modelValue:a(o).title,"onUpdate:modelValue":e[5]||(e[5]=t=>a(o).title=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u6807\u9898"},null,8,["modelValue"])]),_:1}),s(v,{label:"\u5546\u54C1\u8D27\u53F7 (\u5FC5\u586B)"},{default:n(()=>[s(l,{modelValue:a(o).artNo,"onUpdate:modelValue":e[6]||(e[6]=t=>a(o).artNo=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u8D27\u53F7"},null,8,["modelValue"])]),_:1}),s(v,{label:"\u6240\u5C5E\u5382\u5546 (\u5FC5\u586B)"},{default:n(()=>[s(G,{modelValue:a(o).supplierId,"onUpdate:modelValue":e[7]||(e[7]=t=>a(o).supplierId=t),filterable:"",remote:"","reserve-keyword":"",placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u5382\u5546",disabled:a(o).supplierId!="","remote-show-suffix":"","remote-method":fe,loading:a(D)},{default:n(()=>[(x(!0),H(R,null,Xe(a(z),t=>(x(),q(be,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","loading"])]),_:1}),s(v,{label:"\u5546\u54C1\u989C\u8272"},{default:n(()=>[s(G,{class:"w100-full",modelValue:a(o).colors,"onUpdate:modelValue":e[8]||(e[8]=t=>a(o).colors=t),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u989C\u8272",onChange:e[9]||(e[9]=t=>J())},null,8,["modelValue"])]),_:1}),s(v,{label:"\u5546\u54C1\u5C3A\u7801"},{default:n(()=>[s(G,{class:"w100-full",modelValue:a(o).sizes,"onUpdate:modelValue":e[10]||(e[10]=t=>a(o).sizes=t),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5C3A\u7801",onChange:e[11]||(e[11]=t=>J())},null,8,["modelValue"])]),_:1}),s(v,{label:"\u5546\u54C1\u89C4\u683C"},{default:n(()=>[s(Z,{data:a(o).skuList,border:""},{default:n(()=>[s(r,{prop:"color",label:"\u989C\u8272"}),s(r,{prop:"size",label:"\u5C3A\u7801"}),s(r,{label:"\u4EF7\u683C(\u5143)"},{default:n(({row:t})=>[s(l,{modelValue:t.price,"onUpdate:modelValue":w=>t.price=w,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(r,{label:"\u5E93\u5B58(\u4EF6)"},{default:n(({row:t})=>[s(l,{modelValue:t.stock,"onUpdate:modelValue":w=>t.stock=w,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5E93\u5B58"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"]),u("div",ml,[fl,s(l,{modelValue:a(V),"onUpdate:modelValue":e[12]||(e[12]=t=>L(V)?V.value=t:null),placeholder:"\u8BF7\u8F93\u5165\u4EF7\u683C"},null,8,["modelValue"]),s(l,{modelValue:a(y),"onUpdate:modelValue":e[13]||(e[13]=t=>L(y)?y.value=t:null),placeholder:"\u8BF7\u8F93\u5165\u5E93\u5B58"},null,8,["modelValue"]),s(d,{type:"primary",icon:a(Je),onClick:ge},{default:n(()=>[g("\u6279\u91CF\u8BBE\u7F6E")]),_:1},8,["icon"])])]),_:1}),a(o).supplierId?(x(),H(R,{key:0},[s(v,{label:"\u5546\u54C1\u4E3B\u56FE"},{default:n(()=>[s(c,{"file-list":a(o).indexImages,"onUpdate:file-list":e[14]||(e[14]=t=>a(o).indexImages=t),action:a(te),"list-type":"picture-card","on-success":W,multiple:"",limit:5,"on-preview":T,"on-remove":K,"on-exceed":_e,headers:a(M)(),data:{supplierId:a(o).supplierId,type:"index"},name:"files",accept:"image/*"},{default:n(()=>[s(ee,null,{default:n(()=>[s(a(F))]),_:1})]),_:1},8,["file-list","action","headers","data"])]),_:1}),s(v,{label:"\u8BE6\u60C5\u56FE"},{default:n(()=>[s(c,{"file-list":a(o).detailImages,"onUpdate:file-list":e[15]||(e[15]=t=>a(o).detailImages=t),action:a(te),"list-type":"picture-card","on-success":W,multiple:"",limit:50,"on-preview":T,"on-remove":K,"on-exceed":he,headers:a(M)(),data:{supplierId:a(o).supplierId,type:"index"},name:"files",accept:"image/*"},{default:n(()=>[s(ee,null,{default:n(()=>[s(a(F))]),_:1})]),_:1},8,["file-list","action","headers","data"])]),_:1})],64)):A("v-if",!0)]),_:1},8,["model"])])]),_:1},8,["title","modelValue"]),s(le,{modelValue:a(C),"onUpdate:modelValue":e[18]||(e[18]=t=>L(C)?C.value=t:null)},{default:n(()=>[u("img",{style:{width:"100%"},src:a(X)},null,8,_l)]),_:1},8,["modelValue"])],64)}}},Ql=qe(hl,[["__scopeId","data-v-53922493"],["__file","D:/workCode/yy-danhong-enter/src/views/goods/Goods.vue"]]);export{Ql as default};
