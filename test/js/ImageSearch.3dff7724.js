import{j as te,n as se,D as ie,l as ne,m as re,F as de,o as ue,p as pe,q as ce,r as me,t as fe,u as _e,v as ge,w as ve,x as he,y as be,A as U}from"./element-plus.e2f6c87e.js";import"./vue.71d9eb96.js";import{j as ye,u as z,k as Ie,d as we}from"./api.6033fc19.js";import{_ as Ve}from"./index.fb21dd1c.js";import{p as D}from"./@element-plus.ffb1aafe.js";import{b as d,i as ke,$ as Ue,o as _,c as S,a as u,R as Se,u as n,P as R,Q as s,W as e,F,G as Ee,U as g,V as E,a5 as Le,T as j,ax as xe,ay as Ce}from"./@vue.261fc3d1.js";import"./lodash-es.39464d94.js";import"./@vueuse.95af7be7.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./axios.451cdb92.js";import"./async-validator.55f0915b.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.6a15212d.js";import"./qs.541cb51f.js";import"./side-channel.ba01de6f.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.01dab752.js";import"./vue-router.921957ed.js";import"./pinia.e3c5cb31.js";import"./vue-demi.0e4c1019.js";import"./default-passive-events.a10ec130.js";const B=I=>(xe("data-v-5b762ced"),I=I(),Ce(),I),Ne={class:"page-main image-search-container"},Pe={class:"search-box"},Te={class:"custom-tabs-label"},ze=B(()=>u("span",null,"\u4E0A\u4F20\u56FE\u7247\u641C\u7D22",-1)),De={class:"search-up-box"},Re=["src"],Fe=B(()=>u("p",{class:"desc"},"(\u4E0A\u4F20\u56FE\u7247\u5373\u5F00\u59CB\u641C\u7D22)",-1)),Be={class:"tablelist"},$e={class:"imgbox"},Ae={class:"form-cont"},Me={class:"pvder"},je=B(()=>u("div",{class:"label"},"\u6279\u91CF\u8BBE\u7F6E\u4EF7\u683C\uFF0C\u5E93\u5B58",-1)),He={__name:"ImageSearch",setup(I){let w=d(null),v=d(null);function H(o,a){w.value=URL.createObjectURL(a.raw),console.log(o),o.code==0?L.value=(o==null?void 0:o.data)||[]:U.error(o.msg),h.value=!1}var h=d(!1);function G(o){return h.value=!0,!0}async function O(){h.value=!0;let o=await Ie({imgUrl:v.value});console.log(o),o.code==0?L.value=(o==null?void 0:o.data)||[]:U.error(o.msg),h.value=!1}function q(o){let a=[];Array.isArray(o)&&(a=o.map(p=>p.price));let t=Array.from(new Set(a)).sort(function(p,f){return p-f});return t.length>1?`${t[0]}\u5143~${t[t.length-1]}\u5143`:t[0]+"\u5143"}function Q(){v.value=null,w.value=null}const L=d([]),$=d(0);ke(()=>{$.value=window.innerHeight-220});const i=Ue({title:"",artNo:"",supplierId:"",colors:[],sizes:[],skuList:[],indexImages:[],detailImages:[],id:""}),x=d(!1),V=d([]),W=async o=>{if(o.trim()){x.value=!0;let a=await supplierListByName({name:o,formData:!0});a.code===0&&(V.value=a.data||[]),x.value=!1}else V.value=[]},C=d(!1),A=d(1),N=d(!1);async function J(o){if(N.value)return;N.value=!0,b.value="",y.value="";let a=await we({id:o.id});if(a.code===0){let{data:t}=a;A.value=2,C.value=!0,V.value=[{name:t==null?void 0:t.supplierName,id:t==null?void 0:t.supplierId}],i.title=(t==null?void 0:t.title)||"",i.artNo=(t==null?void 0:t.artNo)||"",i.supplierId=(t==null?void 0:t.supplierId)||"",i.id=t==null?void 0:t.id;let p=[],f=[];t==null||t.skuList.forEach(r=>{delete r.productId,p.push(r.color),f.push(r.size)}),i.skuList=(t==null?void 0:t.skuList)||[],i.colors=[...new Set(p)],i.sizes=[...new Set(f)],i.indexImages=[],i.detailImages=[],t.imgList.forEach(r=>{r.type===1&&i.indexImages.push({path:r.url,url:r.showImg,ntpath:r.url}),r.type===2&&i.detailImages.push({path:r.url,url:r.showImg,ntpath:r.url})}),console.log(i)}else U.error((a==null?void 0:a.msg)||"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF");N.value=!1}const b=d(""),y=d("");function K(){if(!b.value&&!y.value)return U.warning("\u8BF7\u8F93\u5165\u4EF7\u683C\u548C\u5E93\u5B58");i.skuList.forEach(o=>{o.price=b.value,o.stock=y.value})}return(o,a)=>{const t=te,p=se,f=ie,r=ne,P=re,X=de,c=ue,Y=pe,Z=ce,M=me,m=fe,ee=_e,T=ge,le=ve,ae=he,oe=be;return _(),S(F,null,[u("div",Ne,[u("div",Pe,[Se((_(),R(X,{"element-loading-text":"\u6B63\u5728\u641C\u7D22",type:"border-card",onTabChange:Q,class:"demo-tabs"},{default:s(()=>[e(f,null,{label:s(()=>[u("span",Te,[e(t),ze])]),default:s(()=>[u("div",De,[e(p,{class:"search-uploader",action:n(ye),"show-file-list":!1,"on-success":H,"before-upload":G,headers:n(z)(),accept:"image/*"},{default:s(()=>[n(w)?(_(),S("img",{key:0,src:n(w),class:"search"},null,8,Re)):(_(),R(t,{key:1,class:"search-uploader-icon"},{default:s(()=>[e(n(D))]),_:1}))]),_:1},8,["action","headers"]),Fe])]),_:1}),e(f,{class:"url-box",label:"\u8F93\u5165URL\u641C\u7D22"},{default:s(()=>[e(r,{modelValue:n(v),"onUpdate:modelValue":a[0]||(a[0]=l=>Ee(v)?v.value=l:v=l),placeholder:"\u8BF7\u8F93\u5165URL"},null,8,["modelValue"]),e(P,{type:"primary",onClick:O},{default:s(()=>[g("\u641C\u7D22")]),_:1})]),_:1})]),_:1})),[[oe,n(h)]])]),u("div",Be,[e(M,{data:L.value,border:"",stripe:"",class:"ctanel","header-cell-style":{background:"#f5f7fa"},height:$.value},{empty:s(()=>[e(Z,{description:"\u6682\u65E0\u6570\u636E"})]),default:s(()=>[e(c,{align:"center",label:"\u5546\u54C1\u6807\u9898"},{default:s(({row:l})=>[g(E(l.title),1)]),_:1}),e(c,{align:"center",label:"\u5546\u54C1\u56FE\u7247",width:"148"},{default:s(({row:l})=>[u("div",$e,[e(Y,{src:l.showIndexImage,class:"shoumain","preview-teleported":!0,"preview-src-list":[l.showIndexImage],"initial-index":4},null,8,["src","preview-src-list"])])]),_:1}),e(c,{align:"center",label:"\u5546\u54C1\u8D27\u53F7"},{default:s(({row:l})=>[g(E(l.artNo),1)]),_:1}),e(c,{align:"center",label:"\u5546\u54C1\u4EF7\u683C"},{default:s(({row:l})=>[g(E(q(l.skuList)),1)]),_:1}),e(c,{align:"center",label:"\u6240\u5C5E\u5382\u5546"},{default:s(({row:l})=>[g(E(l.supplierName),1)]),_:1}),e(c,{align:"center",label:"\u64CD\u4F5C",width:"170"},{default:s(({row:l})=>[e(P,{type:"primary",icon:o.Edit,link:"",onClick:k=>J(l)},{default:s(()=>[g("\u67E5\u770B")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data","height"])])]),e(ae,{title:`${A.value===1?"\u6DFB\u52A0":"\u7F16\u8F91"}\u5546\u54C1`,modelValue:C.value,"onUpdate:modelValue":a[12]||(a[12]=l=>C.value=l),width:"800px","close-on-click-modal":!1},{default:s(()=>[u("div",Ae,[e(le,{disabled:"",model:n(i),"label-width":"110px"},{default:s(()=>[e(m,{label:"\u5546\u54C1\u6807\u9898 (\u5FC5\u586B)"},{default:s(()=>[e(r,{modelValue:n(i).title,"onUpdate:modelValue":a[1]||(a[1]=l=>n(i).title=l),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u6807\u9898"},null,8,["modelValue"])]),_:1}),e(m,{label:"\u5546\u54C1\u8D27\u53F7 (\u5FC5\u586B)"},{default:s(()=>[e(r,{modelValue:n(i).artNo,"onUpdate:modelValue":a[2]||(a[2]=l=>n(i).artNo=l),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u8D27\u53F7"},null,8,["modelValue"])]),_:1}),e(m,{label:"\u6240\u5C5E\u5382\u5546 (\u5FC5\u586B)"},{default:s(()=>[e(T,{modelValue:n(i).supplierId,"onUpdate:modelValue":a[3]||(a[3]=l=>n(i).supplierId=l),filterable:"",remote:"","reserve-keyword":"",placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u5382\u5546",disabled:n(i).supplierId!="","remote-show-suffix":"","remote-method":W,loading:x.value},{default:s(()=>[(_(!0),S(F,null,Le(V.value,l=>(_(),R(ee,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","loading"])]),_:1}),e(m,{label:"\u5546\u54C1\u989C\u8272"},{default:s(()=>[e(T,{class:"w100-full",modelValue:n(i).colors,"onUpdate:modelValue":a[4]||(a[4]=l=>n(i).colors=l),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u989C\u8272",onChange:a[5]||(a[5]=l=>o.colorSizeChange())},null,8,["modelValue"])]),_:1}),e(m,{label:"\u5546\u54C1\u5C3A\u7801"},{default:s(()=>[e(T,{class:"w100-full",modelValue:n(i).sizes,"onUpdate:modelValue":a[6]||(a[6]=l=>n(i).sizes=l),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5C3A\u7801",onChange:a[7]||(a[7]=l=>o.colorSizeChange())},null,8,["modelValue"])]),_:1}),e(m,{label:"\u5546\u54C1\u89C4\u683C"},{default:s(()=>[e(M,{data:n(i).skuList,border:""},{default:s(()=>[e(c,{prop:"color",label:"\u989C\u8272"}),e(c,{prop:"size",label:"\u5C3A\u7801"}),e(c,{label:"\u4EF7\u683C(\u5143)"},{default:s(({row:l})=>[e(r,{modelValue:l.price,"onUpdate:modelValue":k=>l.price=k,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(c,{label:"\u5E93\u5B58(\u4EF6)"},{default:s(({row:l})=>[e(r,{modelValue:l.stock,"onUpdate:modelValue":k=>l.stock=k,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5E93\u5B58"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"]),u("div",Me,[je,e(r,{modelValue:b.value,"onUpdate:modelValue":a[8]||(a[8]=l=>b.value=l),placeholder:"\u8BF7\u8F93\u5165\u4EF7\u683C"},null,8,["modelValue"]),e(r,{modelValue:y.value,"onUpdate:modelValue":a[9]||(a[9]=l=>y.value=l),placeholder:"\u8BF7\u8F93\u5165\u5E93\u5B58"},null,8,["modelValue"]),e(P,{type:"primary",icon:o.Mouse,onClick:K},{default:s(()=>[g("\u6279\u91CF\u8BBE\u7F6E")]),_:1},8,["icon"])])]),_:1}),n(i).supplierId?(_(),S(F,{key:0},[e(m,{label:"\u5546\u54C1\u4E3B\u56FE"},{default:s(()=>[e(p,{"file-list":n(i).indexImages,"onUpdate:file-list":a[10]||(a[10]=l=>n(i).indexImages=l),action:o.uploadImageUrls,"list-type":"picture-card",multiple:"",limit:5,"on-preview":o.handlePictureCardPreview,"on-remove":o.handleRemove,"on-exceed":o.handleExceedIndex,headers:n(z)(),data:{supplierId:n(i).supplierId,type:"index"},name:"files",accept:"image/*"},{default:s(()=>[e(t,null,{default:s(()=>[e(n(D))]),_:1})]),_:1},8,["file-list","action","on-preview","on-remove","on-exceed","headers","data"])]),_:1}),e(m,{label:"\u8BE6\u60C5\u56FE"},{default:s(()=>[e(p,{"file-list":n(i).detailImages,"onUpdate:file-list":a[11]||(a[11]=l=>n(i).detailImages=l),action:o.uploadImageUrls,"list-type":"picture-card",multiple:"",limit:50,"on-preview":o.handlePictureCardPreview,"on-remove":o.handleRemove,"on-exceed":o.handleExceedDetis,headers:n(z)(),data:{supplierId:n(i).supplierId,type:"index"},name:"files",accept:"image/*"},{default:s(()=>[e(t,null,{default:s(()=>[e(n(D))]),_:1})]),_:1},8,["file-list","action","on-preview","on-remove","on-exceed","headers","data"])]),_:1})],64)):j("v-if",!0)]),_:1},8,["model"])]),j(` <template #footer>\r
            <span class="dialog-footer">\r
                <el-button @click="popShow = false">\u53D6\u6D88</el-button>\r
                <el-button v-if="popShowType === 1" type="primary" @click="addSaveEdit"\r
                    v-loading="addLoading">\u4FDD\u5B58</el-button>\r
                <el-button v-if="popShowType === 2" type="primary" @click="addSaveEdit"\r
                    v-loading="addLoading">\u4FEE\u6539</el-button>\r
            </span>\r
        </template> `)]),_:1},8,["title","modelValue"])],64)}}},bl=Ve(He,[["__scopeId","data-v-5b762ced"],["__file","D:/workCode/yy-danhong-enter/src/views/imageSearch/ImageSearch.vue"]]);export{bl as default};
